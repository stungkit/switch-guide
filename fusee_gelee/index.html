
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Switch CFW Guide.">
      
      
        <meta name="author" content="NH Discord Server.">
      
      
        <link rel="canonical" href="https://switch.hacks.guide/fusee_gelee/">
      
      
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.5">
    
    
      
        <title>Fusee gelee - NH Switch Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vulnerability-disclosure-fusee-gelee" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="NH Switch Guide" class="md-header__button md-logo" aria-label="NH Switch Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M352 320c88.4 0 160-71.6 160-160 0-15.3-2.2-30.1-6.2-44.2-3.1-10.8-16.4-13.2-24.3-5.3l-76.8 76.8c-3 3-7.1 4.7-11.3 4.7H336c-8.8 0-16-7.2-16-16v-57.4c0-4.2 1.7-8.3 4.7-11.3l76.8-76.8c7.9-7.9 5.4-21.2-5.3-24.3C382.1 2.2 367.3 0 352 0c-88.4 0-160 71.6-160 160 0 19.1 3.4 37.5 9.5 54.5L19.9 396.1C7.2 408.8 0 426.1 0 444.1 0 481.6 30.4 512 67.9 512c18 0 35.3-7.2 48-19.9l181.6-181.6c17 6.2 35.4 9.5 54.5 9.5zM80 408a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NH Switch Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Fusee gelee
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nh-server/switch-guide" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    NH Switch Guide
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../user_guide/getting_started/" class="md-tabs__link">
          
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../homebrew/" class="md-tabs__link">
          
  
  Homebrew

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../extras/" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../faq/" class="md-tabs__link">
        
  
    
  
  FAQ

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="NH Switch Guide" class="md-nav__button md-logo" aria-label="NH Switch Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M352 320c88.4 0 160-71.6 160-160 0-15.3-2.2-30.1-6.2-44.2-3.1-10.8-16.4-13.2-24.3-5.3l-76.8 76.8c-3 3-7.1 4.7-11.3 4.7H336c-8.8 0-16-7.2-16-16v-57.4c0-4.2 1.7-8.3 4.7-11.3l76.8-76.8c7.9-7.9 5.4-21.2-5.3-24.3C382.1 2.2 367.3 0 352 0c-88.4 0-160 71.6-160 160 0 19.1 3.4 37.5 9.5 54.5L19.9 396.1C7.2 408.8 0 426.1 0 444.1 0 481.6 30.4 512 67.9 512c18 0 35.3-7.2 48-19.9l181.6-181.6c17 6.2 35.4 9.5 54.5 9.5zM80 408a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>

    </a>
    NH Switch Guide
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nh-server/switch-guide" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    NH Switch Guide
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    RCM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            RCM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/rcm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/rcm/entering_rcm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entering RCM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/rcm/sending_payload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sending a payload
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Modchip
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Modchip
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/modchip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/modchip/preparing_hekate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preparing Hekate
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Finalizing Setup
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Finalizing Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/all/cfw_environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Choosing an Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/all/partitioning_sd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Partitioning the microSD for emuMMC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/all/partitioning_sd_syscfw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Partitioning the microSD for sysCFW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/all/sd_preparation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    microSD Preparations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/all/making_essential_backups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Making Essential Backups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/all/launching_cfw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Launching CFW
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Homebrew
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Homebrew
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Homebrew
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/jksv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JKSV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/goldleaf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Goldleaf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/ftpd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FTPD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/nxtheme-installer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NXTheme Installer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/nx-shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NX-Shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/edizon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EdiZon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/tesla-menu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tesla-Menu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/mission-control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MissionControl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/sys-con/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sys-con
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/sys-botbase/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sys-botbase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/sysdvr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SysDVR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/sys-clk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sys-clk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../homebrew/ldn_mitm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ldn_mitm
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/blocking_nintendo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blocking Nintendo servers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/nandrestore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Restoring a NAND Backup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/autorcm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AutoRCM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/game_modding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Game Modding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/adding_udev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux injection without root
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/showing_file_extensions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Showing File Name Extensions (Windows)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/alternate_bootsetups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alternate Boot Setups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/rcm_injectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RCM Payload Injectors Information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/updating/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Updating CFW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/transfer_sd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changing SD cards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/installing_android/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing Android
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extras/installing_linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing Linux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Fusee gelee</h1>

<h2 id="vulnerability-disclosure-fusee-gelee"><strong>Vulnerability Disclosure: Fusée Gelée</strong><a class="headerlink" href="#vulnerability-disclosure-fusee-gelee" title="Permanent link">&para;</a></h2>
<p>This report documents Fusée Gelée, a coldboot vulnerability that allows full,
unauthenticated arbitrary code execution from an early bootROM context via Tegra
Recovery Mode (RCM) on NVIDIA's Tegra line of embedded processors.  As this
vulnerability allows arbitrary code execution on the Boot and Power Management
Processor (BPMP) before any lock-outs take effect, this vulnerability compromises
the entire root-of-trust for each processor, and allows exfiltration of secrets
e.g. burned into device fuses.</p>
<table>
<thead>
<tr>
<th>Quick vitals: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Reporter:</em></td>
<td>Katherine Temkin (@ktemkin)</td>
</tr>
<tr>
<td><em>Affiliation:</em></td>
<td>ReSwitched (https://reswitched.tech)</td>
</tr>
<tr>
<td><em>E-mail:</em></td>
<td>k@ktemkin.com</td>
</tr>
<tr>
<td><em>Affects:</em></td>
<td>Tegra SoCs, independent of software stack</td>
</tr>
<tr>
<td><em>Versions:</em></td>
<td>believed to affect Tegra SoCs released prior to the T186 / X2</td>
</tr>
<tr>
<td><em>Impact:</em></td>
<td>early bootROM code execution with no software requirements, which can lead to full compromise of on-device secrets where USB access is possible</td>
</tr>
<tr>
<td><em>Disclosure</em></td>
<td>public disclosure planned for June 15th, 2018</td>
</tr>
</tbody>
</table>
<h4 id="vulnerability-summary">Vulnerability Summary<a class="headerlink" href="#vulnerability-summary" title="Permanent link">&para;</a></h4>
<p>The USB software stack provided inside the boot instruction rom (IROM/bootROM)
contains a copy operation whose length can be controlled by an attacker. By
carefully constructing a USB control request, an attacker can leverage this
vulnerability to copy the contents of an attacker-controlled buffer over the
active execution stack, gaining control of the Boot and Power Management
processor (BPMP) before any lock-outs or privilege reductions occur. This
execution can then be used to exfiltrate secrets and to load arbitrary code onto
the main CPU Complex (CCPLEX) "application processors" at the highest possible
level of privilege (typically as the TrustZone Secure Monitor at PL3/EL3).</p>
<hr />
<h4 id="public-disclosure-notice">Public Disclosure Notice<a class="headerlink" href="#public-disclosure-notice" title="Permanent link">&para;</a></h4>
<p>This vulnerability is notable due to the significant number and variety of
devices affected, the severity of the issue, and the immutability of the relevant
code on devices already delivered to end users. This vulnerability report
is provided as a courtesy to help aid remediation efforts, guide communication,
and minimize impact to users.</p>
<p>As other groups appear to have this or an equivalent exploit--
<a href="http://team-xecuter.com/team-xecuter-coming-to-your-nintendo-switch-console/">including a group who claims they will be selling access to an implementation of such an exploit</a>--
it is the author and the ReSwitched team's belief that prompt public disclosure
best serves the public interest. By minimizing the information asymmetry between
the general public and exploit-holders and notifying the public, users will be
able to best assess how this vulnerability impacts their personal threat models.</p>
<p>Accordingly, ReSwitched anticipates public disclosure of this vulnerability:
  * If another group releases an implementation of the identified
     vulnerability; or
  * On June 15th, 2018, whichever comes first.</p>
<hr />
<h3 id="vulnerability-details"><strong>Vulnerability Details</strong><a class="headerlink" href="#vulnerability-details" title="Permanent link">&para;</a></h3>
<p>The core of the Tegra boot process is approximated by the following block of
pseudo-code, as obtained by reverse-engineering an IROM extracted from a
vulnerable T210 system:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// If this is a warmboot (from &quot;sleep&quot;), restore the saved state from RAM.</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">read_scratch0_bit</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">restore_warmboot_image</span><span class="p">(</span><span class="o">&amp;</span><span class="n">load_addr</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">// Otherwise, bootstrap the processor.</span>
<span class="k">else</span>
<span class="p">{</span>
<span class="w">  </span><span class="c1">// Allow recovery mode to be forced by a PMC scratch bit or physical straps.</span>
<span class="w">  </span><span class="n">force_recovery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">check_for_rcm_straps</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">read_scratch0_bit</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Determine whether to use USB2 or USB3 for RCM.</span>
<span class="w">  </span><span class="n">determine_rcm_usb_version</span><span class="p">(</span><span class="o">&amp;</span><span class="n">usb_version</span><span class="p">);</span>
<span class="w">  </span><span class="n">usb_ops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">set_up_usb_ops</span><span class="p">(</span><span class="n">usb_version</span><span class="p">);</span>
<span class="w">  </span><span class="n">usb_ops</span><span class="o">-&gt;</span><span class="n">initialize</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// If we&#39;re not forcing recovery, attempt to load an image from boot media.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">force_recovery</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// If we succeeded, don&#39;t fall back into recovery mode.</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">read_boot_configuration_and_images</span><span class="p">(</span><span class="o">&amp;</span><span class="n">load_addr</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">goto</span><span class="w"> </span><span class="n">boot_complete</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// In all other conditions</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">read_boot_images_via_usb_rcm</span><span class="p">(</span><span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">load_addr</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="cm">/* load address is poisoned here */</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nl">boot_complete</span><span class="p">:</span>
<span class="w">  </span><span class="cm">/* apply lock-outs, and boot the program at address load_address  */</span>
</code></pre></div>
<p>Tegra processors include a USB Recovery Mode (RCM), which we can observe to be activated under a number of conditions:
  * If the processor fails to find a valid Boot Control Table (BCT) + bootloader on its boot media;
  * If processor straps are pulled to a particular value e.g. by holding a button combination; or
  * If the processor is rebooted after a particular value is written into a power management controller scratch register.</p>
<p>USB recovery mode is present in all devices, including devices that have been
production secured. To ensure that USB recovery mode does not allow unauthenticated
communications, RCM requires all recovery commands be signed using either RSA
or via AES-CMAC.</p>
<p>The bootloader's implementation of the Tegra RCM protocol is simple, and exists
to allow loading a small piece of code (called the <em>miniloader</em> or <em>applet</em>) into
the bootloader's local Instruction RAM (IRAM). In a typical application, this
<em>applet</em> is <code>nvtboot-recovery</code>, a stub which allows further USB communications to
bootstrap a system or to allow system provisioning.</p>
<p>The RCM process is approximated by the following pseudo-code, again obtained via
reverse engineering a dumped IROM from a T210:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Significantly simplified for clarity, with error checking omitted where unimportant.</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Repeatedly handle USB standard events on the control endpoint EP0.</span>
<span class="w">  </span><span class="n">usb_ops</span><span class="o">-&gt;</span><span class="n">handle_control_requests</span><span class="p">(</span><span class="n">current_dma_buffer</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Try to send the device ID over the main USB data pipe until we succeed.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rcm_send_device_id</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">USB_NOT_CONFIGURED</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">usb_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// Once we&#39;ve made a USB connection, accept RCM commands on EP1.</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">usb_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Read a full RCM command and any associated payload into a global buffer.</span>
<span class="w">    </span><span class="c1">// (Error checking omitted for brevity.)</span>
<span class="w">    </span><span class="n">rcm_read_command_and_payload</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Validate the received RCM command; e.g. by checking for signatures</span>
<span class="w">    </span><span class="c1">// in RSA or AES_CMAC mode, or by trivially succeeding if we&#39;re not in</span>
<span class="w">    </span><span class="c1">// a secure mode.</span>
<span class="w">    </span><span class="n">rc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rcm_validate_command</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">VALIDATION_PASS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">rc</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Handle the received and validated command.</span>
<span class="w">    </span><span class="c1">// For a &quot;load miniloader&quot; command, this sanity checks the (validated)</span>
<span class="w">    </span><span class="c1">// miniloader image and takes steps to prevent re-use of signed data not</span>
<span class="w">    </span><span class="c1">// intended to be used as an RCM command.</span>
<span class="w">    </span><span class="n">rcm_handle_command_complete</span><span class="p">(...);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>It is important to note that a full RCM command <em>and its associated payload</em>
are read into 1) a global buffer, and 2) the target load address, respectively,
before any signature checking is done. This effectively grants the attacker a
narrow window in which they control a large region of unvalidated memory.</p>
<p>The largest vulnerability surface area occurs in the <code>rcm_read_command_and_payload</code>
function, which accepts the RCM command and payload packets via a USB bulk endpoint.
For our purposes, this endpoint is essentially a simple pipe for conveyance
of blocks of binary data separate from standard USB communications.</p>
<p>The <code>rcm_read_command_and_payload</code> function actually contains several issues--
of which exactly one is known to be exploitable:</p>
<div class="highlight"><pre><span></span><code><span class="kt">uint32_t</span><span class="w"> </span><span class="n">total_rxd</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="n">total_to_rx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x400</span><span class="p">;</span>

<span class="c1">// Loop until we&#39;ve received our full command and payload.</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">total_rxd</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">total_to_rx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Switch between two DMA buffers, so the USB is never DMA&#39;ing into the same</span>
<span class="w">  </span><span class="c1">// buffer that we&#39;re processing.</span>
<span class="w">  </span><span class="n">active_buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next_buffer</span><span class="p">;</span>
<span class="w">  </span><span class="n">next_buffer</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">switch_dma_buffers</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Start a USB DMA transaction on the RCM bulk endpoint, which will hopefully</span>
<span class="w">  </span><span class="c1">// receive data from the host in the background as we copy.</span>
<span class="w">  </span><span class="n">usb_ops</span><span class="o">-&gt;</span><span class="n">start_nonblocking_bulk_read</span><span class="p">(</span><span class="n">active_buffer</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1000</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// If we&#39;re in the first 680-bytes we&#39;re receiving, this is part of the RCM</span>
<span class="w">  </span><span class="c1">// command, and we should read it into the command buffer.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">total_rxd</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">680</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* copy data from the DMA buffer into the RCM command buffer until we&#39;ve</span>
<span class="cm">       read a full 680-byte RCM command */</span>

<span class="w">    </span><span class="c1">// Once we&#39;ve received the first four bytes of the RCM command,</span>
<span class="w">    </span><span class="c1">// use that to figure out how much data should be received.</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">total_rxd</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// validate:</span>
<span class="w">      </span><span class="c1">//  -- the command won&#39;t exceed our total RAM</span>
<span class="w">      </span><span class="c1">//     (680 here, 0x30000 in upper IRAM)</span>
<span class="w">      </span><span class="c1">//  -- the command is &gt;= 0x400 bytes</span>
<span class="w">      </span><span class="c1">//  -- the size ends in 8</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rcm_command_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mh">0x302A8u</span>
<span class="w">              </span><span class="o">||</span><span class="w"> </span><span class="n">rcm_command_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">0x400u</span>
<span class="w">              </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">rcm_command_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xF</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ERROR_INVALID_SIZE</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w">  </span><span class="p">{</span>
<span class="w">        </span><span class="n">left_to_rx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">((</span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">rcm_command_buffer</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/* copy any data _past_ the command into a separate payload</span>
<span class="cm">     buffer at 0x40010000 */</span>
<span class="w">  </span><span class="cm">/* -code omitted for brevity - */</span>

<span class="w">  </span><span class="c1">// Wait for the DMA transaction to complete.</span>
<span class="w">  </span><span class="c1">// [This is, again, simplified to convey concepts.]</span>
<span class="w">  </span><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">usb_ops</span><span class="o">-&gt;</span><span class="n">bulk_read_complete</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// While we&#39;re blocking, it&#39;s still important that we respond to standard</span>
<span class="w">    </span><span class="c1">// USB packets on the control endpoint, so do that here.</span>
<span class="w">    </span><span class="n">usb_ops</span><span class="o">-&gt;</span><span class="n">handle_control_requests</span><span class="p">(</span><span class="n">next_buffer</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Astute readers will notice an issue unrelated to the Fusée Gelée exploit: this
code fails to properly ensure DMA buffers are being used exclusively for a single
operation. This results in an interesting race condition in which a DMA buffer
can be simultaneously used to handle a control request and a RCM bulk transfer.
This can break the flow of RCM, but as both operations contain untrusted data,
this issue poses no security risk.</p>
<p>To find the actual vulnerability, we must delve deeper, into the code that handles
standard USB control requests. The core of this code is responsible for responding
to USB control requests. A <em>control request</em> is initiated when the host sends a
setup packet, of the following form:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th style="text-align: center;">&nbsp; &nbsp; &nbsp; &nbsp; Size  &nbsp; &nbsp;</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>direction</td>
<td style="text-align: center;">1b</td>
<td>if '1', the device should respond with data</td>
</tr>
<tr>
<td>type</td>
<td style="text-align: center;">2b</td>
<td>specifies whether this request is of a standard type or not</td>
</tr>
<tr>
<td>recipient</td>
<td style="text-align: center;">5b</td>
<td>encodes the context in which this request should be considered; <br /> for example, is this about a <code>DEVICE</code> or about an <code>ENDPOINT</code>?</td>
</tr>
<tr>
<td>request</td>
<td style="text-align: center;">8b</td>
<td>specifies the request number</td>
</tr>
<tr>
<td>value</td>
<td style="text-align: center;">16b</td>
<td>argument to the request</td>
</tr>
<tr>
<td>index</td>
<td style="text-align: center;">16b</td>
<td>argument to the request</td>
</tr>
<tr>
<td>length</td>
<td style="text-align: center;">16b</td>
<td>specifies the maximum amount of data to be transferred</td>
</tr>
</tbody>
</table>
<p>As an example, the host can request the status of a device by issuing a
<code>GET_STATUS</code> request, at which point the device would be expected to respond with
a short setup packet. Of particular note is the <code>length</code> field of the request,
which should <em>limit</em> -- but not exclusively determine-- the <em>maximum</em> amount of
data that should be included in the response. Per the specification, the device
should respond with either the <em>amount of data specified</em> or the <em>amount of data
available</em>, whichever is less.</p>
<p>The bootloader's implementation of this behavior is conceptually implemented as
follows:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Temporary, automatic variables, located on the stack.</span>
<span class="kt">uint16_t</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data_to_tx</span><span class="p">;</span>

<span class="c1">// The amount of data available to transmit.</span>
<span class="kt">uint16_t</span><span class="w"> </span><span class="n">size_to_tx</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w"> </span><span class="c1">// The amount of data the USB host requested.</span>
<span class="kt">uint16_t</span><span class="w"> </span><span class="n">length_read</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">setup_packet</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>

<span class="cm">/* Lots of handler cases have omitted for brevity. */</span>

<span class="c1">// Handle GET_STATUS requests.</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">setup_packet</span><span class="p">.</span><span class="n">request</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">REQUEST_GET_STATUS</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="c1">// If this is asking for the DEVICE&#39;s status, respond accordingly.</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">setup_packet</span><span class="p">.</span><span class="n">recipient</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">RECIPIENT_DEVICE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">status</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">get_usb_device_status</span><span class="p">();</span>
<span class="w">      </span><span class="n">size_to_tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">status</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// Otherwise, respond with the ENDPOINT status.</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">setup_packet</span><span class="p">.</span><span class="n">recipient</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">RECIPIENT_ENDPOINT</span><span class="p">){</span>
<span class="w">      </span><span class="n">status</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">get_usb_endpoint_status</span><span class="p">(</span><span class="n">setup_packet</span><span class="p">.</span><span class="n">index</span><span class="p">);</span>
<span class="w">      </span><span class="n">size_to_tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length_read</span><span class="p">;</span><span class="w"> </span><span class="c1">// &lt;-- This is a critical error!</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* ... */</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Send the status value, which we&#39;ll copy from the stack variable &#39;status&#39;.</span>
<span class="w">  </span><span class="n">data_to_tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Copy the data we have into our DMA buffer for transmission.</span>
<span class="c1">// For a GET_STATUS request, this copies data from the stack into our DMA buffer.</span>
<span class="n">memcpy</span><span class="p">(</span><span class="n">dma_buffer</span><span class="p">,</span><span class="w"> </span><span class="n">data_to_tx</span><span class="p">,</span><span class="w"> </span><span class="n">size_to_tx</span><span class="p">);</span>

<span class="c1">// If the host requested less data than we have, only send the amount requested.</span>
<span class="c1">// This effectively selects min(size_to_tx, length_read).</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">length_read</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size_to_tx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">size_to_tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length_read</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Transmit the response we&#39;ve constructed back to the host.</span>
<span class="n">respond_to_control_request</span><span class="p">(</span><span class="n">dma_buffer</span><span class="p">,</span><span class="w"> </span><span class="n">length_to_send</span><span class="p">);</span>
</code></pre></div>
<p>In most cases, the handler correctly limits the length of the transmitted
responses to the amount it has available, per the USB specification. However,
in a few notable cases, the length is <em>incorrectly always set to the amount
requested</em> by the host:
  * When issuing a <code>GET_CONFIGURATION</code> request with a <code>DEVICE</code> recipient.
  * When issuing a <code>GET_INTERFACE</code> request with a <code>INTERFACE</code> recipient.
  * When issuing a <code>GET_STATUS</code> request with a <code>ENDPOINT</code> recipient.</p>
<p>This is a critical security error, as the host can request up to 65,535 bytes per
control request. In cases where this is loaded directly into <code>size_to_tx</code>, this
value directly sets the extent of the <code>memcpy</code> that follows-- and thus can copy
up to 65,535 bytes into the currently selected <code>dma_buffer</code>. As the DMA buffers
used for the USB stack are each comparatively short, this can result in a <em>very</em>
significant buffer overflow.</p>
<p>To validate that the vulnerability is present on a given device, one can try
issuing an oversized request and watch as the device responds. Pictured below is
the response generated when sending a oversized <code>GET_STATUS</code> control request
with an <code>ENDPOINT</code> recipient to a T124:</p>
<p><img alt="Reading a chunk of stack memory from a K1" src="../img/stack_read.png" /></p>
<p>A compliant device should generate a two-byte response to a <code>GET_STATUS</code> request--
but the affected Tegra responds with significantly longer response. This is a clear
indication that we've run into the vulnerability described above.</p>
<p>To really understand the impact of this vulnerability, it helps to understand
the memory layout used by the bootROM. For our proof-of-concept, we'll consider
the layout used by the T210 variant of the affected bootROM:</p>
<p><img alt="Bootrom memory layout" src="../img/mem_layout.png" /></p>
<p>The major memory regions relevant to this vulnerability are as follows:
  * The bootROM's <em>execution stack</em> grows downward from <code>0x40010000</code>; so the
    execution stack is located in the memory <em>immediately preceding</em> that address.
  * The DMA buffers used for USB are located at <code>0x40005000</code> and <code>0x40009000</code>,
    respectively. Because the USB stack alternates between these two buffers
    once per USB transfer, the host effectively can control which DMA buffer
    is in use by sending USB transfers.
  * Once the bootloader's RCM code receives a 680-byte command, it begins to store
    received data in a section of upper IRAM located at address <code>0x40010000</code>, and can
    store up to <code>0x30000</code> bytes of payload. This address is notable, as it is immediately
    past the end of the active execution stack.</p>
<p>Of particular note is the adjacency of the bootROM's <em>execution stack</em> and the
attacker-controlled <em>RCM payload</em>. Consider the behavior of the previous pseudo-code
segment on receipt of a <code>GET_STATUS</code> request to the <code>ENDPOINT</code> with an
excessive length. The resulting memcpy:
  * copies <em>up to</em> 65,535 bytes total;
  * sources data from a region <em>starting at the status variable on the stack</em>
    and extending significantly past the stack -- effectively copying mostly
    <em>from the attacker-controllable RCM payload buffer</em>
  * targets a buffer starting either <code>0x40005000</code> or <code>0x40009000</code>, at the
    attacker's discretion, reaching addresses of up to <code>0x40014fff</code> or <code>0x40018fff</code></p>
<p>This is a powerful copy primitive, as it copies <em>from attacker controlled memory</em>
and into a region that <em>includes the entire execution stack</em>:</p>
<p><img alt="Effect of the vulnerability memcpy" src="../img/copy_span.png" /></p>
<p>This would be a powerful exploit on any platform; but this is a particularly devastating
attack in the bootROM environment, which does not:
  * Use common attack mitigations such as stack canaries, ostensibly to reduce
    complexity and save limited IRAM and IROM space.
  * Apply memory protections, so the entire stack and all attacker
    controlled buffers can be read from, written to, and executed from.
  * Employ typical 'application-processor' mitigation strategies such as ASLR.</p>
<p>Accordingly, we now have:
  1. The capability to load arbitrary payloads into memory via RCM, as RCM only
     validates command signatures once payload receipt is complete.
  2. The ability to copy attacker-controlled values over the execution stack,
     overwriting return addresses and redirecting execution to a location of our
     choice.</p>
<p>Together, these two abilities give us a full arbitrary-code execution exploit at
a critical point in the Tegra's start-up process. As control flow is hijacked
before return from <code>read_boot_images_via_usb_rcm</code>, none of the "lock-out"
operations that precede normal startup are executed. This means, for example,
that the T210 fuses-- and the keydata stored within them-- are accessible from
the attack payload, and the bootROM is not yet protected.</p>
<h4 id="exploit-execution">Exploit Execution<a class="headerlink" href="#exploit-execution" title="Permanent link">&para;</a></h4>
<p>The Fusée Launcher PoC exploits the vulnerability described on the T210 via a
careful sequence of interactions:
  1. The device is started in RCM mode. Device specifics will differ, but this
     is often via a key-combination held on startup.
  2. A host computer is allowed to enumerate the RCM device normally.
  3. The host reads the RCM device's ID by reading 16 bytes from the EP1 IN.
  4. The host builds an exploit payload, which is comprised of:
      1. An RCM command that includes a maximum length, ensuring that we can send
         as much payload as possible without completing receipt of the RCM payload.
         Only the length of this command is used prior to validation; so we can
         submit an RCM command that starts with a maximum length of 0x30298, but
         which fills the remaining 676 bytes of the RCM command with any value.
      2. A set of values with which to overwrite the stack. As stack return address
         locations vary across the series, it's recommended that a large block
         composed of a single entry-point address be repeated a significant number
         of times, so one can effectively replace the entire stack with that address.
      3. The program to be executed ("final payload") is appended, ensuring that its
         position in the binary matches the entry-point from the previous step.
      4. The payload is padded to be evenly divisible by the 0x1000 block size to
         ensure the active block is not overwritten by the "DMA dual-use" bug
         described above.
  5. The exploit payload is sent to the device over EP1 OUT, tracking the number of
     0x1000-byte "blocks" that have been sent to the device. If this number is <em>even</em>,
     the next write will be issued to the lower DMA buffer (<code>0x40005000</code>); otherwise,
     it will be issued to the upper DMA buffer (<code>0x40009000</code>).
  6. If the next write would target the lower DMA buffer, issue another write
     of a full 0x1000 bytes to move the target to the upper DMA buffer, reducing
     the total amount of data to be copied.
  7. Trigger the vulnerable memcpy by sending a <code>GET_STATUS</code> <code>IN</code> control
     request with an <code>ENDPOINT</code> recipient, and a length long enough to smash the
     desired stack region, and preferably not longer than required.</p>
<p>A simple host program that triggers this vulnerability is included with this
report: see <code>fusee-launcher.py</code>. Note the restrictions on its function in the
following section.</p>
<hr />
<h3 id="proof-of-concept"><strong>Proof of Concept</strong><a class="headerlink" href="#proof-of-concept" title="Permanent link">&para;</a></h3>
<p>Included with this report is a set of three files:
  * <code>fusee-launcher.py</code> -- The main proof-of-concept accompanying this report.
    This python script is designed to launch a simple binary payload in the
    described bootROM context via the exploit.
  * <code>intermezzo.bin</code> -- This small stub is designed to relocate a payload from
    a higher load address to the standard RCM load address of <code>0x40010000</code>. This
    allows standard RCM payloads (such as <code>nvtboot-recover.bin</code>) to be executed.
  * <code>fusee.bin</code> -- An example payload for the Nintendo Switch, a representative
    and well-secured device based on a T210. This payload will print information
    from the device's fuses and protected IROM to the display, demonstrating that
    early bootROM execution has been achieved.</p>
<p><strong>Support note:</strong> Many host-OS driver stacks are reluctant to issue unreasonably
large control requests. Accordingly, the current proof-of-concept includes code
designed to work in the following environments:
  * <strong>64-bit linux via <code>xhci_hcd</code></strong>. The proof-of-concept can manually submit
    large control requests, but does not work with the common <code>ehci_hcd</code> drivers
    due to driver limitations. A rough rule of thumb is that a connection via a
    blue / USB3 SuperSpeed port will almost always be handled by <code>xhci_hcd</code>.
  * <strong>macOS</strong>. The exploit works out of the box with no surprises or restrictions
    on modern macOS.</p>
<p>Windows support would require addition of a custom kernel module, and thus was
beyond the scope of a simple proof-of-concept.</p>
<p>To use this proof-of-concept on a Nintendo Switch:
  1. Set up an Linux or macOS environment that meets the criteria above, and
     which has a working <code>python3</code> and <code>pyusb</code> as well as <code>libusb</code> installed.
  2. Connect the Switch to your host PC with a USB A -&gt; USB C cable.
  3. Boot the Switch in RCM mode. There are three ways to do this, but the first--
     unseating its eMMC board-- is likely the most straightforward:
      1. Ensure the Switch cannot boot off its eMMC. The most straightforward way to
         to this is to open the back cover and remove the socketed eMMC board; corrupting
         the BCT or bootloader on the eMMC boot partition would also work.
      2. Trigger the RCM straps. Hold VOL_UP and short pin 10 on the right
         JoyCon connector to ground while engaging the power button.
      3. Set bit 2 of PMC scratch register zero. On modern firmwares, this requires
         EL3 or pre-sleep BPMP execution.
  4. Run the <code>fusee-launcher.py</code> with an argument of <code>fusee.bin</code>. (This requires
     <code>intermezzo.bin</code> to be located in the same folder as <code>fusee-launcher.py</code>.)</p>
<pre><code>```
sudo python3 ./fusee-launcher.py fusee.bin
```
</code></pre>
<p>If everything functions correctly, your Switch should be displaying a collection
of fuse and protected-IROM information:</p>
<p><img alt="exploit working" src="../img/switch_hax.jpg" /></p>
<h3 id="recommended-mitigations"><strong>Recommended Mitigations</strong><a class="headerlink" href="#recommended-mitigations" title="Permanent link">&para;</a></h3>
<p>In this case, the recommended mitigation is to correct the USB control request
handler such that it always correctly constrains the length to be transmitted.
This has to be handled according to the type of device:</p>
<ul>
<li><strong>For a device already in consumer hands</strong>, no solution is proposed.
    Unfortunately, access to the fuses needed to configure the device's ipatches
    was blocked when the ODM_PRODUCTION fuse was burned, so no bootROM update
    is possible. It is suggested that consumers be made aware of the situation
    so they can move to other devices, where possible.</li>
<li><strong>For new devices</strong>, the correct solution is likely to introduce an
    new ipatch or new ipatches that limits the size of control request responses.</li>
</ul>
<p>It seems likely that OEMs producing T210-based devices may move to T214 solutions;
it is the hope of the author that the T214's bootROM shares immunity with
the T186. If not, patching the above is a recommended modification to the mask ROM
and/or ipatches of the T214, as well.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 <a href="https://discord.gg/C29hYvh" target="_blank">Nintendo Homebrew</a>, Maintained by the <a href="/about">NH Discord Server</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "navigation.instant", "navigation.expand", "navigation.sections", "navigation.tabs", "navigation.tracking"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c18c5fb9.min.js"></script>
      
    
  </body>
</html>